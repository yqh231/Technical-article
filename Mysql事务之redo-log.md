---
title: MySQL事务之redo log
date: 2018-04-02 10:24:54
tags: 数据库
---

## Redo log是什么?
MySQL数据库作为现在互联网公司内最流行的关系型数据库，相信大家都有工作中使用过。InnoDB是MySQL里最为常用的一种存储引擎，主要面向在线事务处理(OLTP)的应用。今天就让我们来探究一下InnoDB是如何一步一步实现事务的，这次我们先讲事务实现的redo log。

首先我们先明确一下InnoDB的基本体系架构，当我们想要修改DB上某一行数据的时候，InnoDB是把数据从磁盘读取到内存的缓冲池上进行修改。这个时候数据在内存中被修改，与磁盘中相比就存在了差异，我们称这种有差异的数据为*脏页*。InnoDB对脏页的处理不是每次生成脏页就将脏页刷新回磁盘，这样会产生海量的IO操作，严重影响InnoDB的处理性能。对于此，InnoDB有一套完善的处理策略，与我们这次主题关系不大，表过不提。既然脏页与磁盘中的数据存在差异，那么如果在这期间DB出现故障就会造成数据的丢失。为了解决这个问题，redo log就应运而生了。
<!--more-->

## Redo log工作原理
在讲Redo log工作原理之前，先来学习一下MySQL的一些基础：
1. 日志类型
```mermaid
graph LR
    A[MySQL日志类型]
    A-->B["物理日志(存储了数据被修改的值)"]
    A-->C["逻辑日志(存储了逻辑SQL修改语句)"]
```
redo log在数据库重启恢复的时候被使用，因为其属于物理日志的特性，恢复速度远快于逻辑日志。我们经常使用的binlog就属于典型的逻辑日志。
2. checkpoint
checkpoint